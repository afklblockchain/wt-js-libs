<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Contracts][1]
    -   [\_\_getInstance][2]
    -   [getIndexInstance][3]
    -   [getHotelInstance][4]
    -   [decodeLogs][5]
    -   [createInstance][6]
-   [DataModelOptionsType][7]
-   [DataModel][8]
    -   [getWindingTreeIndex][9]
    -   [getTransactionsStatus][10]
    -   [createWallet][11]
    -   [createInstance][12]
-   [OnChainHotel][13]
    -   [initialize][14]
    -   [dataIndex][15]
    -   [setLocalData][16]
    -   [toPlainObject][17]
    -   [\_\_editInfoOnChain][18]
    -   [createOnChainData][19]
    -   [updateOnChainData][20]
    -   [removeOnChainData][21]
    -   [createInstance][22]
-   [WTIndex][23]
    -   [addHotel][24]
    -   [updateHotel][25]
    -   [removeHotel][26]
    -   [getHotel][27]
    -   [getAllHotels][28]
    -   [createInstance][29]
-   [WtLibsOptionsType][30]
-   [WTLibs][31]
    -   [getWTIndex][32]
    -   [getTransactionsStatus][33]
    -   [createInstance][34]
-   [AddHotelResponseInterface][35]
-   [LocationInterface][36]
-   [HotelDataIndex][37]
-   [HotelDescriptionInterface][38]
-   [HotelOnChainDataInterface][39]
-   [HotelInterface][40]
-   [WTIndexInterface][41]
-   [DataModelInterface][42]
-   [RawLogRecordInterface][43]
-   [DecodedLogRecordInterface][44]
-   [TransactionDataInterface][45]
-   [TxInterface][46]
-   [TxReceiptInterface][47]
-   [AdaptedTxResultInterface][48]
-   [AdaptedTxResultsInterface][49]
-   [WalletInterface][50]
-   [KeystoreV3Interface][51]
-   [StoragePointerAccessor][52]
-   [RemotelyBackedDataset][53]
    -   [bindProperties][54]
    -   [isObsolete][55]
    -   [markObsolete][56]
    -   [isDeployed][57]
    -   [markDeployed][58]
    -   [\_genericGetter][59]
    -   [\_genericSetter][60]
    -   [updateRemoteData][61]
    -   [createInstance][62]
-   [FieldDefType][63]
-   [StoragePointer][64]
    -   [\_genericGetter][65]
    -   [\_detectSchema][66]
    -   [\_getStoragePointerAccessor][67]
    -   [\_downloadFromStorage][68]
    -   [createInstance][69]
-   [Storage][70]
    -   [\_computeHash][71]
    -   [create][72]
    -   [update][73]
    -   [get][74]
-   [storageInstance][75]
-   [InMemoryAccessor][76]
-   [Utils][77]
    -   [isZeroAddress][78]
    -   [applyGasCoefficient][79]
    -   [determineDeployedContractFutureAddress][80]
    -   [getCurrentWeb3Provider][81]
    -   [getCurrentBlockNumber][82]
    -   [determineCurrentAddressNonce][83]
    -   [getTransactionReceipt][84]
    -   [getTransaction][85]
    -   [createInstance][86]
-   [Wallet][87]
    -   [setWeb3][88]
    -   [isDestroyed][89]
    -   [getAddress][90]
    -   [unlock][91]
    -   [signAndSendTransaction][92]
    -   [lock][93]
    -   [destroy][94]
    -   [createInstance][95]

## Contracts

Wrapper class for work with Winding Tree's Ethereum
smart contracts.

**Parameters**

-   `web3`  

### \_\_getInstance

Generic method for getting an instance of `web3.eth.Contract`

**Parameters**

-   `name` **[string][96]** of contract, used in errors
-   `abi` **[Object][97]** specification of contract
-   `address` **[string][96]** on which we should look for the contract


-   Throws **[Error][98]** When address is invalid
-   Throws **[Error][98]** When no code is deployed on given address

Returns **web3.eth.Contract** Resulting wrapper contract

### getIndexInstance

Returns a representation of <a href="https://github.com/windingtree/wt-contracts/blob/v0.2.0/contracts/WTIndex.sol">WTIndex.sol</a>.

**Parameters**

-   `address` **[string][96]** 

Returns **web3.eth.Contract** Instance of an Index

### getHotelInstance

Returns a representation of <a href="https://github.com/windingtree/wt-contracts/blob/v0.2.0/contracts/hotel/Hotel.sol">Hotel.sol</a>.

**Parameters**

-   `address` **[string][96]** 

Returns **web3.eth.Contract** Instance of a Hotel

### decodeLogs

Decodes ethereum transaction log values. Currently supports
events from Index and Hotel smart contracts.

**Parameters**

-   `logs` **[Array][99]&lt;[RawLogRecordInterface][100]>** in a raw format

Returns **[Array][99]&lt;[DecodedLogRecordInterface][101]>** Decoded logs

### createInstance

Returns an initialized instance

**Parameters**

-   `web3` **Web3** instance created by `new Web3(provider)`

Returns **[Contracts][102]** 

## DataModelOptionsType

DataModelOptionsType options. May look like this:

    {
      "provider": 'http://localhost:8545',// or another Web3 provider
      "gasCoefficient": 2 // Optional, defaults to 2
    }

Type: {provider: ([string][96] \| [Object][97])?, gasCoefficient: [number][103]?}

**Properties**

-   `provider` **([string][96] \| [Object][97])?** 
-   `gasCoefficient` **[number][103]?** 

## DataModel

DataModel

**Parameters**

-   `options` **[DataModelOptionsType][104]** 

### getWindingTreeIndex

Returns an Ethereum backed Winding Tree index.

**Parameters**

-   `address` **[string][96]** 

Returns **[Promise][105]&lt;WTIndexDataProvider>** 

### getTransactionsStatus

Finds out in what state are Ethereum transactions. All logs
are decoded along the way and some metrics such as min/max blockAge
are computed. If you pass all transactions related to a single
operation (such as updateHotel), you may benefit from the computed
metrics.

**Parameters**

-   `txHashes` **[Array][99]&lt;[string][96]>** 

Returns **[Promise][105]&lt;[AdaptedTxResultsInterface][106]>** 

### createWallet

Returns a wallet instance for given JSON keystore.

**Parameters**

-   `jsonWallet` **[KeystoreV3Interface][107]** 

Returns **[Promise][105]&lt;[Wallet][108]>** 

### createInstance

Creates a configured DataModel instance.

**Parameters**

-   `options` **[DataModelOptionsType][104]** 

Returns **[DataModel][109]** 

## OnChainHotel

Wrapper class for a hotel backed by a smart contract on
Ethereum that's holding `url` pointer to its data.

It provides an accessor to such data in a form of
`StoragePointer` instance under `dataIndex` property.
Every schema-specific implementation details
are dealt with in StoragePointer.

**Parameters**

-   `web3Utils` **[Utils][110]** 
-   `web3Contracts` **[Contracts][102]** 
-   `indexContract` **[Object][97]** 
-   `address` **[string][96]** 

### initialize

Initializes the underlying RemotelyBackedDataset that actually
communicates with the on-chain stored data. If address was provided
in the contsructor, the RemotelyBackedDataset is marked as deployed
and can be used instantly.

Returns **[Promise][105]&lt;void>** 

### dataIndex

Async getter for `StoragePointer` instance.
Since it has to eventually access the `url`
field stored on-chain, it is lazy loaded.
Any data structure that is accessed by StoragePointer
instance has for now be known beforehand, thus the whole
data format of hotel data on `url` is specified here.

Returns **[Promise][105]&lt;[StoragePointer][111]>** 

### setLocalData

Update manager and url properties. Url can never be nulled. Manager
can never be nulled. Manager can be changed only for an un-deployed
contract (without address).

**Parameters**

-   `newData` **[HotelOnChainDataInterface][112]** 

Returns **[Promise][105]&lt;void>** 

### toPlainObject

Helper method that returns a plain object only
with properties with data.

It is not recursive for now, i. e. all off-chain data
has to be accessed separately. Subject to change.

Returns **[Promise][105]&lt;[HotelOnChainDataInterface][112]>** 

### \_\_editInfoOnChain

Updates url on-chain. Used internally as a remoteSetter for `url` property.

**Parameters**

-   `wallet` **[WalletInterface][113]** that signs the transaction
-   `transactionOptions` **[Object][97]** usually contains from and to. Gas is automatically computed.

Returns **[Promise][105]&lt;[string][96]>** resulting transaction hash

### createOnChainData

Creates new hotel contract on-chain.

Precomputes the deployed hotel on-chain address, so even if
the resulting transaction is not yet mined, the address is already known.

Returns once the transaction is signed and sent to network by `wallet`.

**Parameters**

-   `wallet` **[WalletInterface][113]** that signs the transaction
-   `transactionOptions` **[Object][97]** usually contains from and to. Gas is automatically computed.

Returns **[Promise][105]&lt;[Array][99]&lt;[string][96]>>** list of resulting transaction hashes

### updateOnChainData

Updates all hotel-related data by calling `updateRemoteData` on a `RemotelyBackedDataset`
dataset.

**Parameters**

-   `wallet` **[WalletInterface][113]** that signs the transaction
-   `transactionOptions` **[Object][97]** usually contains from and to. Gas is automatically computed.


-   Throws **[Error][98]** When the underlying contract is not yet deployed.
-   Throws **[Error][98]** When url is empty.

Returns **[Promise][105]&lt;[Array][99]&lt;[string][96]>>** List of transaction hashes

### removeOnChainData

Destroys the object on network, in this case, calls a `deleteHotel` on
Winding Tree index contract.

**Parameters**

-   `wallet` **[WalletInterface][113]** that signs the transaction
-   `transactionOptions` **[Object][97]** usually contains from and to. Gas is automatically computed.


-   Throws **[Error][98]** When the underlying contract is not yet deployed.

Returns **[Promise][105]&lt;[Array][99]&lt;[string][96]>>** List of transaction hashes

### createInstance

Create new configured instance.

**Parameters**

-   `web3Utils` **[Utils][110]** 
-   `web3Contracts` **[Contracts][102]** 
-   `indexContract` **web3.eth.Contract** Representation of Winding Tree index
-   `address` **[string][96]** is an optional pointer to Ethereum network where the hotel lives.
    It is used as a reference for on-chain stored data. If it is not provided, a hotel has
    to be created on chain to behave as expected.

Returns **[OnChainHotel][114]** 

## WTIndex

Ethereum smart contract backed implementation of Winding Tree
index wrapper. It provides methods for working with hotel
contracts.

**Parameters**

-   `indexAddress` **[string][96]** 
-   `web3Utils` **[Utils][110]** 
-   `web3Contracts` **[Contracts][102]** 

### addHotel

Adds a totally new hotel on chain. Does not wait for the transactions
to be mined, but as fast as possible returns a list of transaction IDs
and the new hotel on chain address.

**Parameters**

-   `wallet` **[WalletInterface][113]** 
-   `hotelData` **[HotelOnChainDataInterface][112]** 


-   Throws **[Error][98]** When hotelData does not contain url property.
-   Throws **[Error][98]** When anything goes wrong during communication with the network.

Returns **[Promise][105]&lt;[AddHotelResponseInterface][115]>** 

### updateHotel

Updates a hotel on chain. Does not wait for the transactions
to be mined, but as fast as possible returns a list of transaction
IDs so you can keep track of the progress.

**Parameters**

-   `wallet` **[WalletInterface][113]** 
-   `hotel` **[HotelInterface][116]** 


-   Throws **[Error][98]** When hotel does not have a manager field.
-   Throws **[Error][98]** When anything goes wrong during communication with the network.

Returns **[Promise][105]&lt;[Array][99]&lt;[string][96]>>** 

### removeHotel

Removes the hotel from chain. Does not wait for the transactions
to be mined, but as fast as possible returns a list of transaction
IDs so you can keep track of the progress.

**Parameters**

-   `wallet` **[WalletInterface][113]** 
-   `hotel` **[HotelInterface][116]** 


-   Throws **[Error][98]** When anything goes wrong such as-   hotel does not exist
    -   hotel does not belong to the calling manager
    -   not enough gas

Returns **[Promise][105]&lt;[Array][99]&lt;[string][96]>>** 

### getHotel

Gets hotel representation of a hotel on a given address. If hotel
on such address is not registered through this Winding Tree index
instance, the method throws immediately.

**Parameters**

-   `address` **[string][96]** 


-   Throws **[Error][98]** When hotel does not exist.
-   Throws **[Error][98]** When something breaks in the network communication.

Returns **[Promise][105]&lt;[HotelInterface][116]?>** 

### getAllHotels

Returns a list of all hotels. It will filter out
every hotel that is inaccessible for any reason.

Currently does not provide any information on inaccessible
hotels. Subject to change.

Returns **[Promise][105]&lt;[Array][99]&lt;[HotelInterface][116]>>** 

### createInstance

Returns a configured instance of WTIndex
representing a Winding Tree index contract on a given `indexAddress`.

**Parameters**

-   `indexAddress` **[string][96]** 
-   `web3Utils` **[Utils][110]** 
-   `web3Contracts` **[Contracts][102]** 

Returns **[Promise][105]&lt;[WTIndex][117]>** 

## WtLibsOptionsType

General options for wt-libs-js. Holds all things necessary
for successful setup of Winding Tree network.

Type: {dataModelOptions: [DataModelOptionsType][104]}

**Properties**

-   `dataModelOptions` **[DataModelOptionsType][104]** 

## WTLibs

Main public interface of wt-libs-js.

**Parameters**

-   `options` **[WtLibsOptionsType][118]** 

### getWTIndex

Get an instance of Winding Tree index from the underlying `data-model`.

**Parameters**

-   `address` **[string][96]** of the Winding Tree index

Returns **[Promise][105]&lt;[WTIndexInterface][119]>** 

### getTransactionsStatus

Get a transactions status from the underlying `data-model`

**Parameters**

-   `transactionHashes` **[Array][99]&lt;[string][96]>** 

Returns **[Promise][105]&lt;[AdaptedTxResultsInterface][106]>** 

### createInstance

Call this to create wt-libs-js instance.

**Parameters**

-   `options` **[WtLibsOptionsType][118]** 

Returns **[WTLibs][120]** WTLibs

## AddHotelResponseInterface

Response of the addHotel operation.

-   `address` holds the projected address of newly created hotel.
-   `transactionIds` contains an array of ids of related transactions
    that had to be sent to the underlying networks. You can
    use these ids to check on the asynchronous operation state.

**Properties**

-   `address` **[string][96]?** 
-   `transactionIds` **[Array][99]&lt;[string][96]>** 

## LocationInterface

Generic GPS location.

**Properties**

-   `latitude` **[number][103]??** 
-   `longitude` **[number][103]??** 

## HotelDataIndex

Index file for more data urls. This is the
initial document that blockchain is pointing to.

**Properties**

-   `descriptionUrl` **[string][96]** 

## HotelDescriptionInterface

Description of additional hotel data.

**Properties**

-   `location` **([Promise][105]&lt;[LocationInterface][121]?> | [LocationInterface][121]?)** 
-   `name` **([Promise][105]&lt;[string][96]?> | [string][96]?)** 
-   `description` **([Promise][105]&lt;[string][96]?> | [string][96]?)** 

## HotelOnChainDataInterface

Shape of data that is stored on-chain
about every hotel.

-   `address` is the network address.
-   `manager` is the network address of hotel manager.
-   `url` holds a pointer to the off-chain storage
    that is used internally to store data.

**Properties**

-   `address` **([Promise][105]&lt;[string][96]?> | [string][96]?)** 
-   `manager` **([Promise][105]&lt;[string][96]?> | [string][96]?)** 
-   `url` **([Promise][105]&lt;[string][96]?> | [string][96]?)** 

## HotelInterface

**Extends HotelOnChainDataInterface**

Represents a hotel instance that can
communicate with on-chain hotel representation
and provides an access to offChain data via `dataIndex`
property.

**Properties**

-   `dataIndex` **[Promise][105]&lt;[StoragePointer][111]>** 
-   `toPlainObject` **function (): [Promise][105]&lt;[Object][97]>** 
-   `setLocalData` **function (newData: [HotelOnChainDataInterface][112]): [Promise][105]&lt;void>** 
-   `createOnChainData` **function (wallet: [WalletInterface][113], transactionOptions: [Object][97]): [Promise][105]&lt;[Array][99]&lt;[string][96]>>** 
-   `updateOnChainData` **function (wallet: [WalletInterface][113], transactionOptions: [Object][97]): [Promise][105]&lt;[Array][99]&lt;[string][96]>>** 
-   `removeOnChainData` **function (wallet: [WalletInterface][113], transactionOptions: [Object][97]): [Promise][105]&lt;[Array][99]&lt;[string][96]>>** 

## WTIndexInterface

WindingTree index interface that provides all methods
necessary for interaction with the hotels.\`

**Properties**

-   `addHotel` **function (wallet: [WalletInterface][113], hotel: [HotelOnChainDataInterface][112]): [Promise][105]&lt;[AddHotelResponseInterface][115]>** 
-   `getHotel` **function (address: [string][96]): [Promise][105]&lt;[HotelInterface][116]?>** 
-   `getAllHotels` **function (): [Promise][105]&lt;[Array][99]&lt;[HotelInterface][116]>>** 
-   `updateHotel` **function (wallet: [WalletInterface][113], hotel: [HotelInterface][116]): [Promise][105]&lt;[Array][99]&lt;[string][96]>>** 
-   `removeHotel` **function (wallet: [WalletInterface][113], hotel: [HotelInterface][116]): [Promise][105]&lt;[Array][99]&lt;[string][96]>>** 

## DataModelInterface

Formalization of DataModel's public interface.

**Properties**

-   `getWindingTreeIndex` **function (address: [string][96]): [Promise][105]&lt;[WTIndexInterface][119]>** 
-   `getTransactionsStatus` **function (transactionHashes: [Array][99]&lt;[string][96]>): [Promise][105]&lt;[AdaptedTxResultsInterface][106]>** 
-   `createWallet` **function (jsonWallet: [Object][97]): [Promise][105]&lt;[WalletInterface][113]>** 

## RawLogRecordInterface

This interface represents raw ethereum transaction log object
as returned by <a href="http://web3js.readthedocs.io/en/1.0/web3-eth.html#eth-getpastlogs-return">getPastLogs</a>.
Sometimes you might need the raw data to do some additional processing.

**Properties**

-   `address` **[string][96]** 
-   `data` **[string][96]** 
-   `topics` **[Array][99]&lt;[string][96]>** 
-   `logIndex` **[number][103]** 
-   `transactionIndex` **[number][103]** 
-   `transactionHash` **[number][103]** 
-   `blockHash` **[number][103]** 
-   `blockNumber` **[number][103]** 

## DecodedLogRecordInterface

This interface represents an Ethereum log record
with decoded data that are much easier to read
and act upon.

**Properties**

-   `address` **[string][96]** 
-   `event` **[string][96]** 
-   `attributes` **[Array][99]&lt;{name: [string][96], type: [string][96], value: [string][96]}>** 

## TransactionDataInterface

Ethereum transaction data used when creating transaction, see for example
[https://web3js.readthedocs.io/en/1.0/web3-eth-accounts.html#signtransaction][122]

**Properties**

-   `nonce` **([string][96] \| [number][103])?** 
-   `chainId` **[string][96]?** 
-   `from` **[string][96]?** 
-   `to` **[string][96]** 
-   `data` **[string][96]** 
-   `value` **[string][96]?** 
-   `gasPrice` **[string][96]?** 
-   `gas` **([string][96] \| [number][103])** 

## TxInterface

Ethereum transaction data after TX was accepted by the network, see
for example [http://web3js.readthedocs.io/en/1.0/web3-eth.html#gettransaction][123]

**Properties**

-   `hash` **[string][96]?** 
-   `nonce` **([string][96] \| [number][103])?** 
-   `blockHash` **[string][96]?** 
-   `blockNumber` **[number][103]?** 
-   `transactionIndex` **[number][103]?** 
-   `from` **[string][96]?** 
-   `to` **[string][96]?** 
-   `value` **[string][96]?** 
-   `gasPrice` **[string][96]?** 
-   `gas` **[number][103]?** 
-   `input` **[string][96]?** 

## TxReceiptInterface

Transaction receipt as returned by
<a href="http://web3js.readthedocs.io/en/1.0/web3-eth.html#eth-gettransactionreceipt-return">getTransactionReceipt</a>.
This raw data might be sometimes needed for additional processing.

**Properties**

-   `transactionHash` **[string][96]** 
-   `blockNumber` **[number][103]** 
-   `blockHash` **[string][96]** 
-   `transactionIndex` **[number][103]** 
-   `from` **[string][96]** 
-   `to` **[string][96]** 
-   `contractAddress` **any** 
-   `cumulativeGasUsed` **[number][103]** 
-   `gasUsed` **[number][103]** 
-   `logs` **[Array][99]&lt;[RawLogRecordInterface][100]>** 
-   `status` **[number][103]** 

## AdaptedTxResultInterface

A custom transaction result interface that informs
about the transaction status, its age and decoded logs.

**Properties**

-   `transactionHash` **[string][96]** 
-   `blockAge` **[number][103]** 
-   `decodedLogs` **[Array][99]&lt;[DecodedLogRecordInterface][101]>** 
-   `raw` **[TxReceiptInterface][124]** 

## AdaptedTxResultsInterface

A cummulative result of multiple transactions. We are
computing how many of the transactions were already
executed, how old are they (which might be useful for making
assumptions about confirmations). This also contains the raw data.

**Properties**

-   `meta` **{total: [number][103], processed: [number][103], minBlockAge: [number][103], maxBlockAge: [number][103], allPassed: [boolean][125]}** 
-   `meta.total` **[number][103]** 
-   `meta.processed` **[number][103]** 
-   `meta.minBlockAge` **[number][103]** 
-   `meta.maxBlockAge` **[number][103]** 
-   `meta.allPassed` **[boolean][125]** 
-   `results` **{}?** 

## WalletInterface

Wallet abstraction interface. It assumes the following workflow:
1\. libs user holds a json wallet
2\. libs user unlocks the wallet abstraction with a password
3\. libs user calls some business logic which internally uses `signAndSendTransaction`
4\. libs user either locks the wallet (if she plans to use it again)
4\. OR destroys the wallet object data by calling `destroy`

`lock` should not remove the data necessary for unlocking the wallet again.
`destroy` on the other hand should clean all data that may be exploited from memory

**Properties**

-   `unlock` **function (password: [string][96]): void** 
-   `signAndSendTransaction` **function (transactionData: [TransactionDataInterface][126], onReceipt: function (receipt: [TxReceiptInterface][124]): void?): [Promise][105]&lt;[string][96]>** 
-   `lock` **function (): void** 
-   `destroy` **function (): void** 
-   `getAddress` **function (): [string][96]** 

## KeystoreV3Interface

Interface for Ethereum keystore

Description: [https://medium.com/@julien.m./what-is-an-ethereum-keystore-file-86c8c5917b97][127]

Specification: [https://github.com/ethereum/wiki/wiki/Web3-Secret-Storage-Definition][128]

**Properties**

-   `version` **[number][103]** 
-   `id` **[string][96]** 
-   `address` **[string][96]** 
-   `crypto` **{ciphertext: [string][96], cipherparams: {iv: [string][96]}, cipher: [string][96], kdf: [string][96], kdfparams: {dklen: [number][103], salt: [string][96], n: [number][103], r: [number][103], p: [number][103]}, mac: [string][96]}** 
-   `crypto.ciphertext` **[string][96]** 
-   `crypto.cipherparams` **{iv: [string][96]}** 
-   `crypto.cipherparams.iv` **[string][96]** 
-   `crypto.cipher` **[string][96]** 
-   `crypto.kdf` **[string][96]** 
-   `crypto.kdfparams` **{dklen: [number][103], salt: [string][96], n: [number][103], r: [number][103], p: [number][103]}** 
-   `crypto.kdfparams.dklen` **[number][103]** 
-   `crypto.kdfparams.salt` **[string][96]** 
-   `crypto.kdfparams.n` **[number][103]** 
-   `crypto.kdfparams.r` **[number][103]** 
-   `crypto.kdfparams.p` **[number][103]** 
-   `crypto.mac` **[string][96]** 

## StoragePointerAccessor

Interface for an off-chain storage access.

**Properties**

-   `download` **function (): [Promise][105]&lt;{}?>** 

## RemotelyBackedDataset

Dataset ready to use various strategies for storing the data
in a remote storage. Every field backed by this strategy should
have a getter and setter defined that interacts with the
remote storage. The dataset strategy may be in the following states:

-   fresh - Purely in-memory created object with no data
-   unsynced - Some data may be set locally, but they were not
    propagated to the remote storage, and no data was loaded from the
    remote storage.
-   deployed - Data has its representation ready on the remote storage
    and we may call remote getters and setters to interact with the remote storage.
-   obsolete - Data lost its representation on the remote storage and
    we should not interact with it anymore.

Internally a state is held for each property. If you `get` a property
that was not previously accessed, the whole dataset gets synced (this might
get more efficient in the future), and you get a current value from
the remote storage. If any value was changed locally, it is considered
as the current value. Once you are done with data modification, you
have to call `updateRemoteData` that propagates the whole dataset to the
remote storage. These calls are deduplicated, so if a single call is used
to update multiple properties, only once call is done.

### bindProperties

Creates generic getters and setters that proxy `remoteGetter` and
`remoteSetter` when necessary.

The fields are specified as an `options.fields` property and every key
represents a single property. Every property's options can than hold
a `remoteGetter` and `remoteSetter` field such as

    {fields: {
        url: {
          remoteGetter: async (): Promise<?string> => {
            return (await this.contract.url().call();
          },
          // this will usually return a transaction ID
          remoteSetter: async (): Promise<string> => {
            return this.contract.methods.callHotel(this.address, data).send(txOptions);
          }
    },

All passed fields are set as unsynced which means that
after the first `get` on any of those, the whole dataset will
be synced from the remote storage (if the dataset is marked as deployed).

**Parameters**

-   `options` **[Object][97]** `{fields: {[field]: fieldOptions}}`
-   `bindTo` **[Object][97]** Object to which the properties will be bound.
    Typically the initiator of this operation.

### isObsolete

Is dataset marked as obsolete?

Returns **[Boolean][125]** 

### markObsolete

Marks dataset as obsolete. Typically called after the remote storage
is destroyed or made inaccessible. This is not propagated anywhere
but merely serves as a flag to prevent further interaction with this object.

### isDeployed

Is dataset deployed to the remote storage?

Returns **[Boolean][125]** 

### markDeployed

Marks dataset as deployed. Typically called when the remote
storage is set up, created or connected to.

### \_genericGetter

Tries to get a value. If the property was not synced before,
it will sync the whole dataset from a remote storage. If a property
was modified locally before, the modified value will be returned.

**Parameters**

-   `property` **[string][96]** 


-   Throws **[Error][98]** When dataset is marked as obsolete

Returns **any** property's current value

### \_genericSetter

Sets a new value locally and marks the property as dirty. Thath
means that even after syncing data from remote storage, the object will still
serve the locally modified value.

**Parameters**

-   `property` **[string][96]** 
-   `newValue` **any** 

### updateRemoteData

Calls all remoteSetters if relevant data was changed.
Calls are deduplicated, so if the same method would be used
to update multiple fields, it is called only once.

**Parameters**

-   `wallet` **[WalletInterface][113]** that signs the transaction
-   `transactionOptions` **[Object][97]** passed to every remoteSetter, typically something like `{from: address, to: address}`

Returns **[Array][99]&lt;any>** Results of remoteSetters, it would typically contain transaction IDs

### createInstance

Generic factory method.

## FieldDefType

Definition of a data field that is stored off-chain.
This may be recursive.

Type: {name: [string][96], isStoragePointer: [boolean][125]?, fields: [Array][99]&lt;([FieldDefType][129] \| [string][96])>?}

**Properties**

-   `name` **[string][96]** 
-   `isStoragePointer` **[boolean][125]?** 
-   `fields` **[Array][99]&lt;([FieldDefType][129] \| [string][96])>?** 

## StoragePointer

`StoragePointer` serves as a representation of an
off-chain document holding JSON data. This generic class
does not enforce any protocol/schema and contains
infrastructure code that helps to set up field definition
and getters for every data field. It does not provide any
means of writing data, its sole purpose is for reading.

It is possible to use this recursively, so you can define
a field as another storage pointer. The configuration is
declarative and may look like this:

    const pointer = StoragePointer.createInstance('some://url', ['name', 'description']);
    pointer.ref; // contains 'some://url',
    await pointer.contents.name;
    await pointer.contents.description;

Or in recursive cases:

    const pointer = StoragePointer.createInstance('some://url', [
      {
        name: 'description',
        isStoragePointer: true,
        fields: ['name', 'description', 'location'],
      },
      'signature'
    ]);
    pointer.ref; // contains  'some://url'
    await pointer.contents.signature;
    const descPointer = await pointer.contents.description;
    descPointer.ref; // contains whatever is written in a description property in a document located on 'some://url'
    await descPointer.contents.name;

Only a top-level properties have to be defined beforehand, so the `signature`
field above may contain a complex JSON object.

**Parameters**

-   `url` **[string][96]** where to look for the data
-   `fields` **[Array][99]&lt;[FieldDefType][129]>** definition from which are generated getters

### \_genericGetter

Lazy data getter. The contents file gets downloaded only
once any data field is accessed for the first time. Also
the recursive `StoragePointer`s are created here only
after the contents of the data is known, because we need
to know the url to be able to instantiate the appropariate
`StoragePointer`.

This behaviour might change in a way that we are able to
swap the StoragePointer implementation during runtime.

**Parameters**

-   `field` **[string][96]** 

Returns **([StoragePointer][111] \| [Object][97])** 

### \_detectSchema

Detects schema from an url, i. e.
from `json://some-data`, detects `json`.

**Parameters**

-   `url` **[string][96]** 

Returns **[string][96]?** 

### \_getStoragePointerAccessor

Returns appropriate implementation of `StoragePointerAccessor`
based on schema. Now, the accessors are hardcoded here, but in
a future implementation it should be possible to configure
a list of available accessor implementations.

**Parameters**

-   `schema` **[string][96]?** 

Returns **[StoragePointerAccessor][130]** 

### \_downloadFromStorage

Gets the data document via `StoragePointerAccessor`.
If nothing is returned, might return an empty object.

Returns **[Promise][105]&lt;{}>** 

### createInstance

Returns a new instance of StoragePointer.

Normalizes the `fields` format before creating the actual
instance

**Parameters**

-   `url` **[string][96]** where to look for data document. It has to include schema, i. e. `https://example.com/data`
-   `fields` **[Array][99]&lt;([FieldDefType][129] \| [string][96])>** list of top-level fields in the referred document

Returns **[StoragePointer][111]** 

## Storage

Simple in-memory key value store that creates
its keys with ethereum based sha3 hash function.

### \_computeHash

Private method that hashes arbitrary data with SHA-3.
Before hashing, data is JSON.stringified and a current
timestamp is prepended to prevent collisions.

**Parameters**

-   `data` **[Object][97]** to be hashed

Returns **[string][96]** resulting sha3 hash

### create

Adds new data to the in-memory storage.

**Parameters**

-   `data` **[Object][97]** 

Returns **[string][96]** hash under which the data is stored

### update

Update data under certain key

**Parameters**

-   `hash` **[string][96]** under which to store new data
-   `data` **[Object][97]** 

### get

Retrieve data from a certain hash

**Parameters**

-   `hash` **[string][96]** under which is the desired data

Returns **[Object][97]** 

## storageInstance

Single instance of Storage that should be used
throughout the whole application.

Type: [Storage][131]

## InMemoryAccessor

StoragePointerAccessor based on a simple in-memory key-value
storage.

**Parameters**

-   `url` **[string][96]** 

## Utils

Collection of utility methods useful during
communication with Ethereum network.

**Parameters**

-   `gasCoefficient` **[number][103]** 
-   `web3` **Web3** 

### isZeroAddress

Is address a zero address? Uses a bignumber.js test

**Parameters**

-   `address` **[string][96]** 

Returns **[boolean][125]** 

### applyGasCoefficient

Multiplies the gas with a previously configured `gasCoefficient`

**Parameters**

-   `gas` **[number][103]** 

Returns **[number][103]** 

### determineDeployedContractFutureAddress

Determines the future address of a deployed contact if such
contact is deployed in a transaction originating from `sender`
with `nonce`. Uses `ethereumjs-util` implementation
and always returns a checksum formatted Ethereum address.

Type: [string][96]

**Parameters**

-   `sender` **[string][96]** 
-   `nonce` **[number][103]** 

Returns **[string][96]** 

### getCurrentWeb3Provider

Proxy method for `web3.currentProvider`

Returns **[Object][97]** 

### getCurrentBlockNumber

Proxy method for `web3.eth.getBlockNumber`

Returns **[Promise][105]&lt;[number][103]>** 

### determineCurrentAddressNonce

Returns current number of transactions mined for given
Ethereum address

**Parameters**

-   `address` **[string][96]** 

Returns **[Promise][105]&lt;[number][103]>** number

### getTransactionReceipt

Proxy method for `web3.eth.getTransactionReceipt`

**Parameters**

-   `txHash` **[string][96]** 

Returns **[TxReceiptInterface][124]** 

### getTransaction

Proxy method for `web3.eth.getTransaction`

**Parameters**

-   `txHash` **[string][96]** 

Returns **[Promise][105]&lt;[TxInterface][132]>** 

### createInstance

Returns an initialized instance

**Parameters**

-   `gasCoefficient` **[number][103]** 
-   `web3` **Web3** instance created by `new Web3(provider)`

Returns **[Contracts][102]** 

## Wallet

Web3 based wallet implementation

**Parameters**

-   `keystoreJsonV3` **[KeystoreV3Interface][107]** 

### setWeb3

Sets up an initialized Web3 instance for later use

**Parameters**

-   `web3` **Web3** 

### isDestroyed

It is not possible to do any operations on a destroyed
wallet. Wallet is destroyed by calling the `destroy()` method.

Returns **[boolean][125]** 

### getAddress

Returns the address passed in `keystoreJsonV3`
in a checksummed format, e.g. prefixed with 0x
and case-sensitive.

-   Throws **[Error][98]** When wallet was destroyed.
-   Throws **[Error][98]** When there's no keystore

Returns **[string][96]** 

### unlock

Unlocks/decrypts the JSON wallet keystore. <strong>From now on
there is a readable privateKey stored in memory!</strong>

**Parameters**

-   `password` **[string][96]** 


-   Throws **[Error][98]** When wallet was destroyed.
-   Throws **[Error][98]** When there is no web3 instance configured.

### signAndSendTransaction

Takes transaction data, signs them with an unlocked private key and sends them to
the network. Resolves immediately after receiving a `transactionHash` event and optionally
may run an `onReceipt` callback after receiving the `receipt` event.

**Parameters**

-   `transactionData` **[TransactionDataInterface][126]** 
-   `onReceipt` **function (receipt: [TxReceiptInterface][124]): void?** 


-   Throws **[Error][98]** When wallet was destroyed.
-   Throws **[Error][98]** When there is no web3 instance configured.
-   Throws **[Error][98]** When wallet is not unlocked.
-   Throws **[Error][98]** When transaction.from does not match the wallet account.

Returns **[Promise][105]&lt;[string][96]>** transaction hash

### lock

Locks the wallet, i. e. deletes the private key from memory.
The original JSON keystore remains in the memory and can
be unlocked again if necessary.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[Error][98]** When wallet was destroyed.

### destroy

Destroys the wallet. It first locks it, thus deleting
the private key from memory and then removes from
memory the JSON file.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[Error][98]** When wallet was destroyed.

### createInstance

Creates an initialized instance

**Parameters**

-   `keystoreJsonV3` **[KeystoreV3Interface][107]** 

Returns **[Wallet][108]** 

[1]: #contracts

[2]: #__getinstance

[3]: #getindexinstance

[4]: #gethotelinstance

[5]: #decodelogs

[6]: #createinstance

[7]: #datamodeloptionstype

[8]: #datamodel

[9]: #getwindingtreeindex

[10]: #gettransactionsstatus

[11]: #createwallet

[12]: #createinstance-1

[13]: #onchainhotel

[14]: #initialize

[15]: #dataindex

[16]: #setlocaldata

[17]: #toplainobject

[18]: #__editinfoonchain

[19]: #createonchaindata

[20]: #updateonchaindata

[21]: #removeonchaindata

[22]: #createinstance-2

[23]: #wtindex

[24]: #addhotel

[25]: #updatehotel

[26]: #removehotel

[27]: #gethotel

[28]: #getallhotels

[29]: #createinstance-3

[30]: #wtlibsoptionstype

[31]: #wtlibs

[32]: #getwtindex

[33]: #gettransactionsstatus-1

[34]: #createinstance-4

[35]: #addhotelresponseinterface

[36]: #locationinterface

[37]: #hoteldataindex

[38]: #hoteldescriptioninterface

[39]: #hotelonchaindatainterface

[40]: #hotelinterface

[41]: #wtindexinterface

[42]: #datamodelinterface

[43]: #rawlogrecordinterface

[44]: #decodedlogrecordinterface

[45]: #transactiondatainterface

[46]: #txinterface

[47]: #txreceiptinterface

[48]: #adaptedtxresultinterface

[49]: #adaptedtxresultsinterface

[50]: #walletinterface

[51]: #keystorev3interface

[52]: #storagepointeraccessor

[53]: #remotelybackeddataset

[54]: #bindproperties

[55]: #isobsolete

[56]: #markobsolete

[57]: #isdeployed

[58]: #markdeployed

[59]: #_genericgetter

[60]: #_genericsetter

[61]: #updateremotedata

[62]: #createinstance-5

[63]: #fielddeftype

[64]: #storagepointer

[65]: #_genericgetter-1

[66]: #_detectschema

[67]: #_getstoragepointeraccessor

[68]: #_downloadfromstorage

[69]: #createinstance-6

[70]: #storage

[71]: #_computehash

[72]: #create

[73]: #update

[74]: #get

[75]: #storageinstance

[76]: #inmemoryaccessor

[77]: #utils

[78]: #iszeroaddress

[79]: #applygascoefficient

[80]: #determinedeployedcontractfutureaddress

[81]: #getcurrentweb3provider

[82]: #getcurrentblocknumber

[83]: #determinecurrentaddressnonce

[84]: #gettransactionreceipt

[85]: #gettransaction

[86]: #createinstance-7

[87]: #wallet

[88]: #setweb3

[89]: #isdestroyed

[90]: #getaddress

[91]: #unlock

[92]: #signandsendtransaction

[93]: #lock

[94]: #destroy

[95]: #createinstance-8

[96]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[97]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[98]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error

[99]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[100]: #rawlogrecordinterface

[101]: #decodedlogrecordinterface

[102]: #contracts

[103]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[104]: #datamodeloptionstype

[105]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[106]: #adaptedtxresultsinterface

[107]: #keystorev3interface

[108]: #wallet

[109]: #datamodel

[110]: #utils

[111]: #storagepointer

[112]: #hotelonchaindatainterface

[113]: #walletinterface

[114]: #onchainhotel

[115]: #addhotelresponseinterface

[116]: #hotelinterface

[117]: #wtindex

[118]: #wtlibsoptionstype

[119]: #wtindexinterface

[120]: #wtlibs

[121]: #locationinterface

[122]: https://web3js.readthedocs.io/en/1.0/web3-eth-accounts.html#signtransaction

[123]: http://web3js.readthedocs.io/en/1.0/web3-eth.html#gettransaction

[124]: #txreceiptinterface

[125]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[126]: #transactiondatainterface

[127]: https://medium.com/@julien.m./what-is-an-ethereum-keystore-file-86c8c5917b97

[128]: https://github.com/ethereum/wiki/wiki/Web3-Secret-Storage-Definition

[129]: #fielddeftype

[130]: #storagepointeraccessor

[131]: #storage

[132]: #txinterface
